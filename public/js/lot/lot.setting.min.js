$("document").ready(function(){b($("#basement :selected").val());var a=0;function b(a){$.ajax({url:urlLoadImage,method:"POST",data:{"_token":$('meta[name="_token"]').attr("content"),basement:a},success:function(a){$("#image_preview").attr("src",JSON.parse(a).image)}})}$("#drawingArea").click(function(e){var a=0,d=$(this),f=d.offset();d.width(),d.height();var g=f.left,h=f.top,b=e.pageX-g,c=e.pageY-h;""==$("#x1").val()&&""==$("#y1").val()&&""==$("#x2").val()&&""==$("#y2").val()&&""==$("#x3").val()&&""==$("#y3").val()&&""==$("#x4").val()&&""==$("#y4").val()&&0==a&&($("#x1").val(b),$("#y1").val(c),a=1),""!=$("#x1").val()&&""!=$("#y1").val()&&""==$("#x2").val()&&""==$("#y2").val()&&""==$("#x3").val()&&""==$("#y3").val()&&""==$("#x4").val()&&""==$("#y4").val()&&0==a&&($("#x2").val(b),$("#y2").val(c),a=1),""!=$("#x1").val()&&""!=$("#y1").val()&&""!=$("#x2").val()&&""!=$("#y2").val()&&""==$("#x3").val()&&""==$("#y3").val()&&""==$("#x4").val()&&""==$("#y4").val()&&0==a&&($("#x3").val(b),$("#y3").val(c),a=1),""!=$("#x1").val()&&""!=$("#y1").val()&&""!=$("#x2").val()&&""!=$("#y2").val()&&""!=$("#x3").val()&&""!=$("#y3").val()&&""==$("#x4").val()&&""==$("#y4").val()&&0==a&&($("#x4").val(b),$("#y4").val(c),a=1)}),$("#savelot").click(function(){var c=parseInt($("#x1").val()),d=parseInt($("#y1").val()),e=parseInt($("#x2").val()),g=parseInt($("#y2").val()),h=parseInt($("#x3").val()),i=parseInt($("#y3").val()),j=parseInt($("#x4").val()),f=parseInt($("#y4").val()),k=$("#lot option:selected").val(),l=f-d,m=e-c,b='<svg style="position: absolute;top: ';b+=d,b+="; left: ",b+=c,b+='" ',b+=' width="',b+=m,b+='" ',b+=' height="',b+=l,b+='" ',b+=' viewBox="',b+=c,b+=" ",b+=d,b+=" ",b+=m,b+=" ",b+=l,b+='"><polygon points="',b+=c,b+=",",b+=d,b+=",",b+=e,b+=",",b+=g,b+=",",b+=h,b+=",",b+=i,b+=",",b+=j,b+=",",b+=f,b+='" ',b+=' style="fill:yellow;stroke:black;stroke-width:1" /></polygon></svg>',$("#drawingArea").append($(b)),url+="/",url+=k,$.ajax({url:url,method:"POST",data:{"_token":$('meta[name="_token"]').attr("content"),id:k,x1_web:c,y1_web:d,x2_web:e,y2_web:g,x3_web:h,y3_web:i,x4_web:j,y4_web:f},success:function(b){b>0?(toastr.success("Update success"),$("#x1").val(""),$("#y1").val(""),$("#x2").val(""),$("#y2").val(""),$("#x3").val(""),$("#y3").val(""),$("#x4").val(""),$("#y4").val(""),a=1):toastr.error("Update failed")}})}),$("#basement").change(function(){b($(this).val())})})